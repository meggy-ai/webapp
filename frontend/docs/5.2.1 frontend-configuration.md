# Environment Variables Documentation

This document provides comprehensive documentation for all environment variables used in the Bruno PA frontend application.

## Overview

The frontend uses a simple centralized configuration system that loads environment variables with inline fallback defaults. All configuration is managed through:

- **`lib/config.ts`** - Configuration loader with inline defaults
- **`.env.local`** - Your local environment variables (optional)
- **`.env.local.example`** - Template with documentation

## Environment Variables Reference

### Required Variables

#### `NEXT_PUBLIC_API_URL`
- **Description**: Base URL for the Bruno PA backend API
- **Type**: String (URL)
- **Required**: No (defaults available)
- **Default**: `http://localhost:8000/api`
- **Example**: 
  ```env
  NEXT_PUBLIC_API_URL=https://api.brunopa.com/api
  ```

### Optional Variables

#### `NEXT_PUBLIC_WS_URL`
- **Description**: WebSocket connection URL for real-time features
- **Type**: String (WebSocket URL)
- **Required**: No
- **Default**: Auto-generated from `NEXT_PUBLIC_API_URL`
- **Example**:
  ```env
  NEXT_PUBLIC_WS_URL=wss://api.brunopa.com/ws
  ```
- **Auto-generation logic**:
  - If API URL is `https://`, WebSocket uses `wss://`
  - If API URL is `http://`, WebSocket uses `ws://`
  - Removes `/api` suffix and adds `/ws`

#### `NEXT_PUBLIC_API_TIMEOUT`
- **Description**: HTTP request timeout in milliseconds
- **Type**: Number (as string)
- **Required**: No
- **Default**: `30000` (30 seconds)
- **Example**:
  ```env
  NEXT_PUBLIC_API_TIMEOUT=45000
  ```

#### `NEXT_PUBLIC_WS_RECONNECT_INTERVAL`
- **Description**: Time between WebSocket reconnection attempts in milliseconds
- **Type**: Number (as string)
- **Required**: No
- **Default**: `5000` (5 seconds)
- **Example**:
  ```env
  NEXT_PUBLIC_WS_RECONNECT_INTERVAL=3000
  ```

#### `NEXT_PUBLIC_WS_MAX_RECONNECT_ATTEMPTS`
- **Description**: Maximum number of WebSocket reconnection attempts
- **Type**: Number (as string)  
- **Required**: No
- **Default**: `5`
- **Example**:
  ```env
  NEXT_PUBLIC_WS_MAX_RECONNECT_ATTEMPTS=10
  ```

#### `NEXT_PUBLIC_APP_NAME`
- **Description**: Display name for the application
- **Type**: String
- **Required**: No
- **Default**: `Bruno Personal Assistant`
- **Example**:
  ```env
  NEXT_PUBLIC_APP_NAME=Bruno PA (Staging)
  ```

#### `NEXT_PUBLIC_APP_ENV`
- **Description**: Environment override (normally auto-detected)
- **Type**: String (`development` | `production` | `test`)
- **Required**: No
- **Default**: Auto-detected from `NODE_ENV`
- **Example**:
  ```env
  NEXT_PUBLIC_APP_ENV=production
  ```

#### `NEXT_TELEMETRY_DISABLED`
- **Description**: Disable Next.js telemetry data collection
- **Type**: String (`1` | `true` to disable)
- **Required**: No
- **Default**: `1` (disabled)
- **Example**:
  ```env
  NEXT_TELEMETRY_DISABLED=1
  ```

## Environment-Specific Configurations

### Development
```env
NEXT_PUBLIC_API_URL=http://localhost:8000/api
NEXT_PUBLIC_WS_URL=ws://localhost:8000/ws
NEXT_PUBLIC_API_TIMEOUT=30000
NEXT_PUBLIC_WS_RECONNECT_INTERVAL=5000
NEXT_PUBLIC_WS_MAX_RECONNECT_ATTEMPTS=5
NEXT_PUBLIC_APP_NAME=Bruno Personal Assistant
NEXT_PUBLIC_APP_ENV=development
NEXT_TELEMETRY_DISABLED=1
```

### Production
```env
NEXT_PUBLIC_API_URL=https://api.brunopa.com/api
NEXT_PUBLIC_WS_URL=wss://api.brunopa.com/ws
NEXT_PUBLIC_API_TIMEOUT=30000
NEXT_PUBLIC_WS_RECONNECT_INTERVAL=5000
NEXT_PUBLIC_WS_MAX_RECONNECT_ATTEMPTS=3
NEXT_PUBLIC_APP_NAME=Bruno Personal Assistant
NEXT_PUBLIC_APP_ENV=production
NEXT_TELEMETRY_DISABLED=0
```

### Test
```env
NEXT_PUBLIC_API_URL=http://localhost:8000/api
NEXT_PUBLIC_WS_URL=ws://localhost:8000/ws
NEXT_PUBLIC_API_TIMEOUT=10000
NEXT_PUBLIC_WS_RECONNECT_INTERVAL=1000
NEXT_PUBLIC_WS_MAX_RECONNECT_ATTEMPTS=2
NEXT_PUBLIC_APP_NAME=Bruno Personal Assistant (Test)
NEXT_PUBLIC_APP_ENV=test
NEXT_TELEMETRY_DISABLED=1
```

## Configuration System

The configuration system uses a simple approach:

1. **Environment Variables** (highest priority) - Read from `.env.local` or deployment environment
2. **Inline Defaults** (fallback) - Hardcoded in `lib/config.ts` for development

All variables are loaded at build time and available throughout the application via the centralized config object.

### Configuration Precedence

The system follows this precedence order:

1. **`.env.local` Environment Variables** (Highest Priority)
   - If you set variables in `.env.local`, they override everything else
   - Example: `NEXT_PUBLIC_API_URL=https://api.production.com/api`

2. **Deployment Environment Variables** (High Priority)
   - Set by hosting platforms (Vercel, Docker, etc.)
   - Takes precedence over inline defaults

3. **Inline Defaults in `lib/config.ts`** (Fallback)
   - Only used when environment variables are not set
   - Default: `http://localhost:8000/api` for development

### How It Works

```typescript
// In lib/config.ts
export const config = {
  api: {
    baseUrl: process.env.NEXT_PUBLIC_API_URL || 'http://localhost:8000/api',
    //       ↑ Takes precedence if set        ↑ Fallback if not set
  }
}
```

### Example Scenarios

**Scenario 1: No `.env.local` file**
- Uses inline default: `http://localhost:8000/api`

**Scenario 2: `.env.local` with custom URL**
```env
NEXT_PUBLIC_API_URL=https://staging.brunopa.com/api
```
- Uses environment variable: `https://staging.brunopa.com/api`

**Scenario 3: Production deployment**
- Environment variables set by deployment platform
- Takes precedence over inline defaults

This approach provides maximum flexibility - developers can work with defaults locally, but you can easily override for staging/production environments without touching code.

## File Priority

Environment variables are loaded in this priority order:

1. **`.env.local`** - Your local environment (highest priority)
2. **`.env.production.local`** / `.env.development.local` - Environment-specific local
3. **`.env.production`** / `.env.development`** - Environment-specific
4. **`.env`** - Default environment file
5. **Inline defaults in `lib/config.ts`** - Code defaults (lowest priority)

## Security Considerations

### Public Variables
- All `NEXT_PUBLIC_*` variables are exposed to the browser
- Never put sensitive data in `NEXT_PUBLIC_*` variables
- API keys, secrets, and passwords should NOT use this prefix

### Git Management
- **`.env.local`** - Gitignored (contains your local config)
- **`.env.local.example`** - Committed (template for others)
- **`.env*.local`** - All gitignored
- **`.env.example`** files - Committed as templates

## Troubleshooting

### Variable Not Loading
1. Check the variable name has `NEXT_PUBLIC_` prefix
2. Restart the development server
3. Verify the variable is in `.env.local`
4. Check for typos in variable names

### Configuration Validation Errors
1. Check the browser console for detailed error messages
2. Verify required variables are set
3. Check URL formats are valid
4. Ensure numeric values are valid numbers

### Environment Detection Issues
1. Check `NEXT_PUBLIC_APP_ENV` if you need to override
2. Verify `NODE_ENV` is set correctly
3. Check the configuration loading order

For more troubleshooting, see the main README.md file.